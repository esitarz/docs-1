<!doctype html>
<html lang="english">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Core Concepts: Rules Engine | OrderCloud Documentation
</title>
  <link rel="canonical" href="../core-concepts/core-concepts-rules-engine.html">


    <link rel="stylesheet" href="../theme/css/style.min.css?f4453825">
  <link rel="stylesheet" href="../theme/css/vendors/pygments/default.min.css">

  
  <meta name="description" content="__Introduction What’s a rules engine? It’s a system that executes rules. Okay...so what’s a rule? In its simplest form, it’s an if-then statement that is provided from the outside, rather than being “baked in” to the engine itself. In the case of OrderCloud.io, we …">


</head>

<body>
  <header class="header">
<nav class="navbar navbar-dark bg-dark">
  <div class="container">
      <a class="navbar-brand" href="../">OrderCloud Documentation</a>
  </div>
</nav>

<!-- <div class="row">
  <div class="col-sm-12">
    <h1 class="title"><a href="../">OrderCloud Documentation</a></h1>
      <ul class="list-inline">
            <li class="list-inline-item"><a href="../frameworks-and-sdks/">Frameworks And Sdks</a></li>
            <li class="list-inline-item"><a href="../integration-services/">Integration Services</a></li>
            <li class="list-inline-item"><a href="../platform-guides/">Platform Guides</a></li>
      </ul>
  </div>
</div> -->  </header>

  <div class="main">
    <div class="container">
      <div class="row">
        <div class="col-sm-3">
            <ul class="nav flex-column">
                <li class="nav-item">
                  <a class="nav-link" href="../category/api-reference.html">API Reference</a>
                    <li>
                        <a class="nav-link" href="../api-reference/Authentication-And-Authorization-ImpersonationConfigs.html">Impersonation Configs</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Authentication-And-Authorization-PasswordResets.html">Forgotten Password</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Authentication-And-Authorization-SecurityProfiles.html">Security Profiles</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-Addresses.html">Addresses</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-ApprovalRules.html">Approval Rules</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-Buyers.html">Buyers</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-CostCenters.html">Cost Centers</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-CreditCards.html">Credit Cards</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-SpendingAccounts.html">Spending Accounts</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-UserGroups.html">User Groups</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Buyers-Users.html">Users</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-Me.html">Me</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeAddresses.html">Addresses</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeCatalogs.html">Catalogs</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeCategories.html">Categories</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeCostCenters.html">Cost Centers</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeCreditCards.html">Credit Cards</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeOrders.html">Orders</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeProducts.html">Products</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MePromotions.html">Promotions</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeShipments.html">Shipments</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeSpendingAccounts.html">Spending Accounts</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Me-And-My-Stuff-MeUserGroups.html">User Groups</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Orders-And-Fulfillment-LineItems.html">Line Items</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Orders-And-Fulfillment-Orders.html">Orders</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Orders-And-Fulfillment-Payments.html">Payments</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Orders-And-Fulfillment-Promotions.html">Promotions</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Orders-And-Fulfillment-Shipments.html">Shipments</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Product-Catalogs-Catalogs.html">Catalogs</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Product-Catalogs-Categories.html">Categories</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Product-Catalogs-PriceSchedules.html">Price Schedules</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Product-Catalogs-Products.html">Products</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Product-Catalogs-Specs.html">Specs</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Seller-AdminAddresses.html">Admin Addresses</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Seller-AdminUserGroups.html">Admin User Groups</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Seller-AdminUsers.html">Admin Users</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Seller-Incrementors.html">Incrementors</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Seller-MessageSenders.html">Message Senders</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Suppliers-SupplierUserGroups.html">Supplier User Groups</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Suppliers-SupplierUsers.html">Supplier Users</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../api-reference/Suppliers-Suppliers.html">Suppliers</a>
                    </li>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../category/core-concepts.html">Core Concepts</a>
                    <li>
                        <a class="nav-link" href="../core-concepts/core-concepts-assignments.html">Core Concepts: Assignments</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../core-concepts/core-concepts-rules-engine.html">Core Concepts: Rules Engine</a>
                    </li>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../category/frameworks-and-sdks.html">Frameworks And Sdks</a>
                    <li>
                        <a class="nav-link" href="../frameworks-and-sdks/angularjs-application-files.html">Angularjs: Application Files</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../frameworks-and-sdks/angularjs-connecting-to-your-organization.html">Angularjs: Connecting To Your Organization</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../frameworks-and-sdks/angularjs-contributing.html">Angularjs: Contributing</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../frameworks-and-sdks/angularjs-source-directory.html">Angularjs: Source Directory</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../frameworks-and-sdks/csharp-getting-started.html">Csharp: Getting Started</a>
                    </li>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../category/integration-services.html">Integration Services</a>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-authorize-and-capture-transaction.html">Authorizenet: Authorize And Capture Transaction</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-authorize-only-transaction.html">Authorizenet: Authorize Only Transaction</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-create-credit-card.html">Authorizenet: Create Credit Card</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-delete-credit-card.html">Authorizenet: Delete Credit Card</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-prior-authorization-capture-transaction.html">Authorizenet: Prior Authorization Capture Transaction</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-refund-transaction.html">Authorizenet: Refund Transaction</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-update-credit-card.html">Authorizenet: Update Credit Card</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/authorizenet-void-transaction.html">Authorizenet: Void Transaction</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/shippingrates-configuring-catalog.html">Shippingrates: Configuring Catalog</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/shippingrates-configuring-integration.html">Shippingrates: Configuring Integration</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/shippingrates-get-line-item-rates.html">Shippingrates: Get Line Item Rates</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/shippingrates-get-rates.html">Shippingrates: Get Rates</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/shippingrates-overview.html">Shippingrates: Overview</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../integration-services/shippingrates-set-shipping-cost.html">Shippingrates: Set Shipping Cost</a>
                    </li>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../category/platform-guides.html">Platform Guides</a>
                    <li>
                        <a class="nav-link" href="../platform-guides/authentication-anonymous-shopping.html">Authentication: Anonymous Shopping</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/authentication-developer-access.html">Authentication: Developer Access</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/authentication-impersonation.html">Authentication: Impersonation</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/authentication-oauth2-workflows.html">Authentication: Oauth2 Workflows</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/authentication-refresh-tokens.html">Authentication: Refresh Tokens</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/authentication-security-profiles.html">Authentication: Security Profiles</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-conventions.html">Basic Api Features: Conventions</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-errors.html">Basic Api Features: Errors</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-extended-properties.html">Basic Api Features: Extended Properties</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-filtering.html">Basic Api Features: Filtering</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-http-methods.html">Basic Api Features: Http Methods</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-pagination.html">Basic Api Features: Pagination</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-searching.html">Basic Api Features: Searching</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/basic-api-features-sorting.html">Basic Api Features: Sorting</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/getting-started-introduction-to-ordercloud.html">Getting Started: Introduction To Ordercloud</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/getting-started-quick-start-guide.html">Getting Started: Quick Start Guide</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/getting-started-using-the-api-console.html">Getting Started: Using The Api Console</a>
                    </li>
                    <li>
                        <a class="nav-link" href="../platform-guides/getting-started-using-the-dashboard.html">Getting Started: Using The Dashboard</a>
                    </li>
                </li>
            </ul>
        </div>
        <div class="col-sm-9">
          <h1>  Core Concepts: Rules Engine
</h1>
          <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2018-03-19T15:32:44.250255-05:00">
          <i class="far fa-clock"></i>
          Mon 19 March 2018
        </li>
        <li class="list-inline-item">
          <i class="far fa-folder-open-o"></i>
          <a href="../category/core-concepts.html">Core Concepts</a>
        </li>
          <li class="list-inline-item">
            <i class="far fa-user"></i>
              <a href="../author/ordercloudio.html">OrderCloud.io</a>          </li>
          <li class="list-inline-item">
            <i class="far fa-files"></i>
              <a href="../tag/core-concepts.html">#core concepts</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h2>__Introduction</h2>
<p>What’s a rules engine? It’s a system that executes rules. Okay...so what’s a
rule? In its simplest form, it’s an if-then statement that is provided from
the outside, rather than being “baked in” to the engine itself. In the case of
OrderCloud.io, we’ll define the “thens” (starting with “order requires
approval”) and allow you to define the “ifs” via custom <strong>logic expressions</strong>.
Effectively, we’re going to allow you to extend platform behavior in much the
same way xp allows you to extend the data model.</p>
<p>Here is an example:</p>
<p>Say you want every order over $200 with some specific xp value to require
approval from a manager. You would first create a UserGroup containing all
approving managers, then create a new ApprovalRule, set the ApprovingGroupID,
and set the Expression to this:</p>
<h2>__Supported Operations</h2>
<ul>
<li><code>order</code> supports the same properties as the Order model returned from /orders API endpoints, including xp.</li>
<li><code>=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code> comparison operators are supported.</li>
<li><code>and</code>, <code>or</code> and <code>not</code> logical operators are supported</li>
<li><code>+</code>, <code>-</code>,<code>*</code> and <code>/</code> mathematical operators are supported</li>
<li>String values must be enclosed in single quotes.</li>
<li>Date values must be enclosed in # symbols, i.e #5/15/2016#</li>
<li>Parentheses may be used to enclose sub-expressions and control order of execution.</li>
</ul>
<h2>__Line Item Control</h2>
<p>What about line items? Glad you asked, because which products are being
purchased, in what quantities, charged against which cost centers, etc, are
very common in the world of approval rules. But line items are a collection,
so we turn to aggregate functions to inspect them. Here’s how you would
require approval on all orders over $200 charged to cost center ABC:</p>
<p>That’s pretty powerful, but it’s more likely that you only care about the
<em>subtotal</em> of just the line items matching your CostCenter condition. For this
you can use the <code>items.total</code> function:</p>
<p>The condition inside the function (called a filter) can be more complex and
contain <code>and</code>, <code>or</code>, etc. just like other parts of the expression:</p>
<p>It also has access to a special filter that allows you check whether a product
is in a certain category:</p>
<p><code>items</code> supports a total of four functions:</p>
<ul>
<li><code>items.any</code> (true if any item matches filter)</li>
<li><code>items.all</code> (true if all item matches filter)</li>
<li><code>items.quantity</code> (compare result to a number)</li>
<li><code>items.total</code> (compare result to a dollar amount)</li>
</ul>
<p>and one special filter:</p>
<ul>
<li><code>product.incategory('mycustomcategory')</code></li>
</ul>
<h2>__ComplexApprovals</h2>
<p>Speaking of functions, there is one defined on <code>order</code>:</p>
<p>This one’s powerful, because it allows you to set up multi-level approval
workflows by chaining rules together. For example, in a larger organization,
getting the approval from a department manager might not be enough, and a
higher-level VP must also sign off.</p>
<p>All valid elements of rule expressions can be mixed &amp; matched as needed,
allowing for very sophisticated rules to be supported:</p>
<p>A word of caution: Rules are easy to write and very powerful, but can be very
tricky to debug when they don’t work quite like you thought they would. Don’t
get more fancy with them than you need to. As always, we’re here to help if
you need guidance.</p>
<h2>__Where to go from here?</h2>
<p>You can also leverage the power of the rules engine to create custom
Promotions. Both the promotion EligibleExpression and ValueExpression accept
expressions just like the ones described above. Here are some other things we
may leverage the rules engine for in the future:</p>
<ul>
<li>Custom validation (upon creating/editing things)</li>
<li>Time-based approval rules (aggregated totals over past week/month/quarter, etc.)</li>
<li>Applying discounts/markups</li>
<li>Replenish inventory</li>
<li>Fire off a notification via webhooks</li>
</ul>
<p>We’d love to get your thoughts on these ideas. Look for significant
enhancements to the rules engine and new applications of it in the months
ahead.</p>
    </div>
  </article>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="../authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="../archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="../categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="../tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>
</body>

</html>